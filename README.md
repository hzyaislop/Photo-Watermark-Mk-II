# Photo Watermark Mk II

Photo Watermark Mk II 是一个使用 Electron + React 打造的跨平台桌面应用，帮助你批量为图片添加文本水印。应用专注于高效的本地处理：利用 `sharp` 提供的高性能图像管线，实现即时预览与批量导出，同时保留可定制的水印模板体验。

## ✨ 功能特性

- **多种导入方式**：支持拖拽、文件选择和整文件夹导入，自动过滤非图片文件。
- **实时预览**：在调整水印文字、字号、颜色、透明度和位置时即时看到效果。
- **九宫格与自定义定位**：内置九宫格预设，并可在预览中拖动圆形锚点完成任意位置布局。
- **批量导出**：一次性对所有导入图片应用水印，可选择输出目录、命名规则（原名/前缀/后缀）以及导出格式（JPEG 或 PNG）。
- **模板管理**：保存当前水印配置为模板，支持加载与删除；应用会自动记忆上次使用的配置。
- **文件安全**：默认禁止导出到原文件夹，确保不会意外覆盖原图。

> 📌 当前版本实现了 PRD 中的全部必选需求，可选高级功能（字体选择、图片水印、旋转、尺寸调整等）仍在规划中。

## 🛠 技术栈

- [Electron Forge](https://www.electronforge.io/)（主进程 + 打包）
- [React 19](https://react.dev/) + TypeScript（渲染进程）
- [Sharp](https://sharp.pixelplumbing.com/)（图像处理）

## 🚀 快速开始

1. **安装依赖**

   ```bash
   npm install
   ```

2. **启动开发模式**（会自动打开 Electron 应用）

   ```bash
   npm run start
   ```

3. （可选）**代码检查**

   ```bash
   npm run lint
   ```

> 默认使用系统的 Node.js 环境。建议 Node 版本 ≥ 18 以获得更佳的 Sharp 兼容性。

## 📚 使用指南

1. **导入图片**：
   - 点击“选择文件”或“选择文件夹”，或直接拖拽文件/文件夹到窗口左侧区域。
   - 支持 JPEG、PNG、BMP、TIFF 等常见格式。

2. **调整水印**：
   - 在右侧“参数设置”中修改文本内容、字号、颜色、透明度和位置。
   - 选择“自定义”位置后，可在预览图中拖动圆形锚点进行精确定位。

3. **管理模板**：
   - 在“水印模板”区域输入名称并保存。
   - 从下拉列表选择模板后，点击“加载模板”即可恢复配置。
   - 支持删除不需要的模板；应用会自动记住最近一次使用的设置。

4. **批量导出**：
   - 在“批量导出”区域选择输出目录和命名规则。
   - 可选择导出格式（PNG 或 JPEG）。
   - 点击“开始导出”并关注进度条与状态提示；失败文件会附带原因列表。

## 📦 构建与发布

Electron Forge 已配置好基础命令，可使用下列指令打包：

```bash
npm run make
```

生成的安装包会位于 `out/` 目录下。根据目标平台不同，Forge 会输出对应的安装格式（如 `.deb`、`.rpm`、`.zip` 等）。

## 🗺️ 规划与后续工作

- 图片水印（支持 PNG Logo 与缩放）。
- 字体选择与更多文本样式（描边、阴影等）。
- 输出质量、尺寸调整、旋转等高级导出选项。
- 模板导入/导出、重命名与分组管理。
- 自动化测试与端到端流程覆盖。

欢迎在 GitHub Issues 分享你的需求或建议，一起完善 Photo Watermark Mk II！
